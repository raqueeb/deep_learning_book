# ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç, ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Ö‡¶ï‡ßç‡¶∏‡¶´‡ßã‡¶∞‡ßç‡¶° ‡¶á‡¶â‡¶®‡¶ø‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶ø‡¶ü‡¶ø ‡¶≠‡¶ø‡¶ú‡ßç‡¶Ø‡ßÅ‡ßü‡¶æ‡¶≤ ‡¶ú‡¶ø‡¶ì‡¶Æ‡ßá‡¶ü‡ßç‡¶∞‡¶ø ‡¶ó‡ßç‡¶∞‡ßÇ‡¶™‡ßá‡¶∞ vgg16 ‡¶°‡ßá‡¶ü‡¶æ‡¶∏‡ßá‡¶ü

{% hint style="info" %}
‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶¨‡¶á ‡¶™‡ßú‡¶õ‡¶ø, ‡¶®‡ßã‡¶ü‡¶¨‡ßÅ‡¶ï ‡¶ï‡ßá‡¶® ‡¶™‡ßú‡¶¨‡ßã? 

‡¶®‡ßã‡¶ü‡¶¨‡ßÅ‡¶ï ‡¶∏‡¶¨‡¶∏‡¶Æ‡ßü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶°‡•§ ‡¶è‡¶á ‡¶¨‡¶á ‡¶•‡ßá‡¶ï‡ßá‡¶ì‡•§ 

‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ ‡¶ó‡¶ø‡¶ü‡¶¨‡ßÅ‡¶ï‡ßá ‡¶®‡ßã‡¶ü‡¶¨‡ßÅ‡¶ï ‡¶†‡¶ø‡¶ï‡¶Æ‡¶§‡ßã ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶π‡ßü‡¶®‡¶æ, ‡¶∏‡ßá‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶ï‡ßã‡¶≤‡¶æ‡¶¨ ‡¶è‡¶¨‡¶Ç ‡¶ó‡¶ø‡¶ü‡¶π‡¶æ‡¶¨‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶â‡¶ö‡¶ø‡ßé‡•§ ‡¶ó‡¶ø‡¶ü‡¶π‡¶æ‡¶¨ ‡¶≤‡¶ø‡¶Ç‡¶ï: 

‡¶®‡¶ø‡¶ú‡ßá ‡¶®‡¶ø‡¶ú‡ßá ‡¶™‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ü‡¶ø‡¶∏ ‡¶ï‡¶∞‡ßÅ‡¶®: [https://github.com/raqueeb/TensorFlow2/blob/master/tf2\_transfer\_learning\_v3.ipynb](https://github.com/raqueeb/TensorFlow2/blob/master/tf2_transfer_learning_v3.ipynb) ‡¶è‡¶¨‡¶Ç [https://nbviewer.jupyter.org/github/raqueeb/TensorFlow2/blob/master/tf2\_transfer\_learning\_v3.ipynb](https://nbviewer.jupyter.org/github/raqueeb/TensorFlow2/blob/master/tf2_transfer_learning_v3.ipynb)

‡¶ï‡ßã‡¶≤‡¶æ‡¶¨ ‡¶≤‡¶ø‡¶Ç‡¶ï: [https://colab.research.google.com/github/raqueeb/TensorFlow2/blob/master/tf2\_transfer\_learning\_v3.ipynb](https://colab.research.google.com/github/raqueeb/TensorFlow2/blob/master/tf2_transfer_learning_v3.ipynb)
{% endhint %}

## ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶è‡¶¨‡¶Ç ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Ö‡¶ï‡ßç‡¶∏‡¶´‡ßã‡¶∞‡ßç‡¶° ‡¶á‡¶â‡¶®‡¶ø‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶ø‡¶ü‡¶ø‚Äô‡¶∞ ‡¶≠‡¶ø‡¶ú‡ßç‡¶Ø‡ßÅ‡ßü‡¶æ‡¶≤ ‡¶ú‡¶ø‡¶ì‡¶Æ‡ßá‡¶ü‡ßç‡¶∞‡¶ø ‡¶ó‡ßç‡¶∞‡ßÇ‡¶™‡ßá‡¶∞ vgg16 ‡¶°‡¶æ‡¶ü‡¶æ‡¶∏‡ßá‡¶ü

‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá‡¶á ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶¨‡ßá‡¶∂‡¶ø ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶¨‡ßç‡¶Ø‡¶æ‡¶™‡¶æ‡¶∞‡¶ü‡¶æ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§ ‡¶Ø‡ßá‡¶Æ‡¶®, ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏ ‡¶∂‡¶ø‡¶ñ‡¶ø ‡¶§‡¶¨‡ßá ‡¶∏‡ßá‡¶á ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏‡¶ü‡¶æ ‡¶Ø‡ßá ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶® ‡¶ï‡¶æ‡¶ú‡ßá ‡¶≤‡¶æ‡¶ó‡ßá ‡¶®‡¶æ ‡¶∏‡ßá‡¶ü‡¶æ ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶†‡¶ø‡¶ï ‡¶®‡¶Ø‡¶º‡•§ ‡¶ß‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ï, ‡¶è‡¶ï ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Ü‡¶Æ‡¶ø ‡¶Ö‡¶Ç‡¶ï, ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶ú‡ßá‡¶¨‡¶∞‡¶æ ‡¶∂‡¶ø‡¶ñ‡ßá‡¶õ‡¶ø, ‡¶™‡¶æ‡¶∂‡¶æ‡¶™‡¶æ‡¶∂‡¶ø ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶® ‡¶∂‡¶ø‡¶ñ‡ßá‡¶õ‡¶ø ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶Ø‡¶º ‡¶™‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ ‡¶è‡¶ñ‡¶® ‡¶∏‡ßá‡¶á ‡¶ú‡ßç‡¶û‡¶æ‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶Æ‡ßá‡¶∂‡¶ø‡¶® ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶∂‡¶ø‡¶ñ‡¶§‡ßá ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá‡•§ ‡¶Ö‡¶Ç‡¶ï,‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶ú‡ßá‡¶¨‡¶∞‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶® ‡¶∂‡ßá‡¶ñ‡¶æ‡¶ü‡¶æ ‡¶¨‡ßÉ‡¶•‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§ ‡¶ï‡¶æ‡¶∞‡¶£, ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶Æ‡ßá‡¶∂‡¶ø‡¶® ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶è‡¶ï‡ßá‡¶¨‡¶æ‡¶∞‡ßá ‡¶ï‡ßá‡¶Å‡¶ö‡ßá ‡¶ó‡¶£‡ßç‡¶°‡ßÇ‡¶∑ ‡¶ï‡¶∞‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶Ø‡¶º‡¶®‡¶ø, ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶Ö‡¶Ç‡¶ï ‡¶è‡¶¨‡¶Ç ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶® ‡¶™‡¶æ‡¶∂‡¶æ‡¶™‡¶æ‡¶∂‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶ú‡ßá‡¶¨‡¶∞‡¶æ ‡¶è‡¶á ‡¶Æ‡ßá‡¶∂‡¶ø‡¶® ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶∂‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡•§ ‡¶∏‡ßá ‡¶ï‡¶æ‡¶∞‡¶£‡ßá‡¶á ‡¶¨‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º ‡¶Ø‡¶¶‡¶ø‡¶ì ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡ßã‡¶® ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∂‡¶ø‡¶ñ‡¶ø, ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º ‡¶™‡¶∞‡ßá ‡¶ì‡¶á ‡¶∂‡ßá‡¶ñ‡¶æ‡¶ü‡¶æ ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ï‡¶æ‡¶ú‡ßá ‡¶≤‡¶æ‡¶ó‡¶õ‡ßá‡•§ ‡¶è‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶• ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ö‡¶§‡ßÄ‡¶§‡ßá ‡¶Ø‡¶æ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∂‡¶ø‡¶ñ‡ßá‡¶õ‡¶ø ‡¶∏‡ßá‡¶ü‡¶æ ‡¶è‡¶ñ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá ‡¶≤‡¶æ‡¶ó‡¶õ‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∂‡¶ø‡¶ñ‡¶§‡ßá‡•§ ‡¶∏‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶è‡¶ï ‡¶°‡ßã‡¶Æ‡ßá‡¶á‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶∞‡ßá‡¶ï ‡¶°‡ßã‡¶Æ‡ßá‡¶á‡¶®‡ßá ‡¶ú‡ßç‡¶û‡¶æ‡¶®‡¶ü‡¶æ ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§

‡¶õ‡ßã‡¶ü‡¶¨‡ßá‡¶≤‡¶æ‡¶Ø‡¶º ‡¶∏‡¶æ‡¶á‡¶ï‡ßá‡¶≤ ‡¶ö‡¶æ‡¶≤‡¶æ‡¶®‡ßã ‡¶∂‡¶ø‡¶ñ‡ßá‡¶õ‡¶ø‡¶≤‡¶æ‡¶Æ ‡¶¨‡¶≤‡ßá‡¶á ‡¶Æ‡ßã‡¶ü‡¶∞‡¶∏‡¶æ‡¶á‡¶ï‡ßá‡¶≤ ‡¶ß‡¶∞‡¶§‡ßá ‡¶ñ‡ßÅ‡¶¨ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ï‡ßá‡¶â ‡¶Ø‡¶¶‡¶ø ‡¶Æ‡ßã‡¶ü‡¶∞‡¶∏‡¶æ‡¶á‡¶ï‡ßá‡¶≤ ‡¶ö‡¶æ‡¶≤‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶® ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶§‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ó‡¶æ‡¶°‡¶º‡¶ø ‡¶ö‡¶æ‡¶≤‡¶æ‡¶®‡ßã‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶™‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ß‡¶∞‡¶§‡ßá ‡¶∏‡ßá ‡¶∞‡¶ï‡¶Æ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶•‡¶æ ‡¶®‡¶æ‡•§ ‡¶¨‡¶æ‡¶ö‡ßç‡¶ö‡¶æ‡¶∞‡¶æ ‡¶Ø‡¶ñ‡¶® ‡¶ï‡ßã‡¶® ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶∂‡ßá‡¶ñ‡ßá, ‡¶§‡¶æ‡¶∞‡¶æ ‡¶π‡¶†‡¶æ‡ßé ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶á‡¶™‡ßç‡¶Ø‡¶æ‡¶° ‡¶™‡ßá‡¶≤‡ßá ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶™‡ßÅ‡¶∞‡¶®‡ßã ‡¶ú‡ßç‡¶û‡¶æ‡¶® ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá‡¶á ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶®‡ßá‡¶Ø‡¶º ‡¶®‡¶§‡ßÅ‡¶® ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏‡•§ ‡¶è‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶• ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶è‡¶ï‡¶ü‡¶æ‡¶∞ ‡¶®‡¶≤‡ßá‡¶ú ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶æ‡¶§‡ßá ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá‡•§ ‡¶è‡¶á ‡¶è‡¶ï‡¶á ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏ ‡¶ò‡¶ü‡¶õ‡ßá ‡¶°‡¶ø‡¶™ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶æ ‡¶®‡¶§‡ßÅ‡¶® ‡¶ß‡¶æ‡¶∞‡¶£‡¶æ‡¶Ø‡¶º‡•§ ‚Äò‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç‚Äô‡•§ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ï‡¶æ‡¶ú‡ßá ‡¶è‡¶ï‡¶ü‡¶æ ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá ‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßá ‡¶∏‡ßá‡¶ü‡¶æ‡¶ï‡ßá ‡¶Ø‡ßá ‡¶™‡¶æ‡¶∂‡¶æ‡¶™‡¶æ‡¶∂‡¶ø ‡¶Ü‡¶∞ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ï‡¶æ‡¶ú‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ ‡¶∏‡ßá‡¶ü‡¶æ ‡¶†‡¶ø‡¶ï ‡¶®‡¶Ø‡¶º‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶°‡¶ø‡¶™ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá ‡¶Ø‡¶¶‡¶ø ‚Äò‡¶á‡¶Æ‡ßá‡¶ú‚Äô ‡¶∞‡¶ø‡¶≤‡ßá‡¶ü‡ßá‡¶° ‡¶¨‡ßç‡¶Ø‡¶æ‡¶™‡¶æ‡¶∞‡ßá ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶æ‡¶á, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶ì‡¶á ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ï‡¶æ‡¶õ‡¶æ‡¶ï‡¶æ‡¶õ‡¶ø ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶æ ‡¶ï‡¶æ‡¶ú‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§ ‡¶ì‡¶á ‡¶¶‡ßÅ‡¶ü‡ßã ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶Ø‡¶§ ‚Äò‡¶∏‡¶ø‡¶Æ‡¶ø‡¶≤‡¶æ‡¶∞‡¶ø‡¶ü‡¶ø‚Äô ‡¶Ü‡¶õ‡ßá ‡¶§‡¶§‡ßã‡¶á ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶∏‡¶π‡¶ú ‡¶π‡¶¨‡ßá‡•§ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶ó‡ßã‡¶°‡¶º‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶≤‡ßá‡¶ì ‡¶™‡¶∞‡ßá‡¶∞ ‡¶ï‡¶æ‡¶õ‡¶æ‡¶ï‡¶æ‡¶õ‡¶ø ‡¶∏‡ßá‡¶á ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶ó‡ßã‡¶°‡¶º‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶æ‡¶®‡ßã‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶®‡ßá‡¶á‡•§ ‡¶è‡¶ü‡¶æ‡¶á ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç‡•§

‡¶ó‡ßã‡¶°‡¶º‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá ‡¶Æ‡ßá‡¶∂‡¶ø‡¶® ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶è‡¶¨‡¶Ç ‡¶°‡¶ø‡¶™ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶ó‡¶∞‡¶ø‡¶¶‡¶Æ‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶è‡¶Æ‡¶®‡¶≠‡¶æ‡¶¨‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤ ‡¶Ø‡¶æ‡¶§‡ßá ‡¶∏‡ßá ‡¶è‡¶ï‡¶ü‡¶æ ‡¶∏‡ßç‡¶™‡ßá‡¶∏‡¶ø‡¶´‡¶ø‡¶ï ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶è‡¶á ‡¶Æ‡¶°‡ßá‡¶≤‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶è‡¶ï‡ßá‡¶¨‡¶æ‡¶∞‡ßá ‡¶ó‡ßã‡¶°‡¶º‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶§‡ßã ‡¶Ø‡¶ñ‡¶® ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶∏‡ßç‡¶™‡ßá‡¶∏ ‡¶°‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶¨‡¶ø‡¶â‡¶∂‡¶®‡ßá ‡¶ï‡ßã‡¶® ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶Ü‡¶∏‡¶§‡ßã‡•§ ‡¶è‡¶ñ‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶∏‡ßç‡¶™‡ßá‡¶∏‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶Ü‡¶∏‡¶≤‡ßá‡¶ì ‡¶ï‡¶æ‡¶õ‡¶æ‡¶ï‡¶æ‡¶õ‡¶ø ‡¶ï‡¶æ‡¶ú‡ßá ‡¶è‡¶ï‡¶ü‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá‡•§ ‡¶∏‡ßá ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ó‡¶§ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶ü‡¶æ‡¶∞‡ßá ‡¶Ü‡¶≤‡¶æ‡¶™ ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá‡•§ ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶è‡¶ï‡¶ü‡¶æ ‚Äò‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ï‡ßÉ‡¶§‚Äô ‡¶¨‡¶æ ‚Äò‡¶∏‡ßá‡¶≠‡¶ï‡ßÉ‡¶§‚Äô ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶Ø‡¶æ‡¶ï‡ßá ‡¶Ü‡¶ó‡ßá‡¶á ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡¶ø‡¶≤ ‡¶¨‡¶ø‡¶∂‡¶æ‡¶≤ ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶æ ‡¶°‡¶æ‡¶ü‡¶æ‡¶∏‡ßá‡¶ü‡ßá‡¶∞ ‡¶â‡¶™‡¶∞‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶∏‡ßá‡¶á ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶æ ‡¶ï‡¶æ‡¶ú‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ö‡¶•‡¶¨‡¶æ ‚Äò‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç‚Äô ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶™‡ßÅ‡¶∞‡ßã ‡¶¨‡¶æ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶Ö‡¶Ç‡¶∂ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶á‡¶ú ‡¶ï‡¶∞‡¶¨‡ßã‡•§ ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶Ø‡¶¶‡¶ø ‡¶ï‡ßã‡¶ü‡¶ø ‡¶ï‡ßã‡¶ü‡¶ø ‡¶á‡¶Æ‡ßá‡¶ú‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶æ‡¶®‡ßã ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶∏‡ßá‡¶á ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá ‡¶ì‡¶á ‡¶õ‡¶¨‡¶ø‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‚Äò‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç‚Äô ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§ ‚Äò‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç‚Äô ‡¶è‡¶∞ ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶¨‡¶°‡¶º ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶Ø‡¶ñ‡¶® ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶π‡¶æ‡¶§‡ßá ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶•‡¶æ‡¶ï‡ßá ‡¶®‡¶æ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ ‡¶∏‡ßá‡¶á ‡¶ú‡ßç‡¶û‡¶æ‡¶®‡¶ï‡ßá ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ü‡¶∏‡¶õ‡¶ø ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶° ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§ ‡¶ú‡ßç‡¶û‡¶æ‡¶® ‡¶•‡ßá‡¶ï‡ßá‡•§

‡¶ß‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ï ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶è‡¶ï‡¶ü‡¶æ ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶Ü‡¶õ‡ßá ‡¶Ø‡ßá‡¶ó‡ßÅ‡¶≤‡ßã ‡¶™‡ßç‡¶∞‡¶æ‡¶Ø‡¶º ‡ßß‡ß¶‡ß¶‡ß¶ ‡¶õ‡¶¨‡¶ø ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø‡¶§‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡•§ ‡¶è‡¶ñ‡¶® ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶¶‡ßÅ‡¶ü‡ßã ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶õ‡¶ø ‡¶∏‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶æ ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶ï‡ßã‡¶® ‡¶∞‡¶ï‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶õ‡¶æ‡¶°‡¶º‡¶æ‡¶á ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§ ‡¶Ü‡¶∏‡¶≤ ‡¶ï‡¶•‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶°‡¶ø‡¶™ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Æ‡¶°‡ßá‡¶≤‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Ø‡ßá ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá - ‡¶∏‡ßá‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ó‡ßã‡¶°‡¶º‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‚Äò‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™‚Äô ‡¶§‡ßà‡¶∞‡¶ø ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∂‡ßá‡¶∑‡ßá ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Ö‡¶Ç‡¶∂‡¶ü‡ßÅ‡¶ï‡ßÅ ‡¶´‡ßá‡¶≤‡ßá ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶≤‡ßá‡¶á ‡¶ï‡¶æ‡¶ú ‡¶π‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§ ‡¶Æ‡¶æ‡¶®‡ßá ‡¶è‡¶ï‡¶ú‡¶®‡ßá‡¶∞ ‡¶∂‡¶∞‡ßÄ‡¶∞, ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ú‡¶®‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶•‡¶æ‡•§ ‡¶Æ‡¶ú‡¶æ‡¶∞ ‡¶ï‡¶•‡¶æ, ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏‡¶ü‡¶æ ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá‡•§

```python
try:
  # ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶ü‡ßá‡¶®‡ßç‡¶∏‡¶∞-‡¶´‡ßç‡¶≤‡ßã ‡ß®.x ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßã 
  %tensorflow_version 2.x
except Exception:
  pass

import tensorflow as tf
keras = tf.keras
```

```text
TensorFlow 2.x selected.
```

```python
# ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶π‡ßá‡¶≤‡ßç‡¶™‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡¶ø

import tensorflow as tf
from tensorflow.keras import layers
import tensorflow_datasets as tfds
import matplotlib.pylab as plt
```

```python
# ‡¶ü‡ßá‡¶®‡ßç‡¶∏‡¶∞-‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡¶ø, ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßá‡¶®‡¶∂‡¶® ‡¶è‡¶¨‡¶Ç ‡¶≤‡¶ó ‡¶°‡¶ø‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶∞‡¶ø ‡¶¶‡ßá‡¶ñ‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡¶ø

%load_ext tensorboard
LOG_DIR = './log'
```

```python
# ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶¨‡¶ø‡ßú‡¶æ‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶ï‡ßÅ‡¶ï‡ßÅ‡¶∞‡ßá‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ‡¶∏‡ßá‡¶ü ‡¶®‡¶ø‡ßü‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶õ‡¶ø, ‡¶¶‡ßá‡¶ñ‡ßá ‡¶®‡¶ø‡¶® '‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶è‡¶≠‡¶æ‡¶∞‡ßá‡¶ú ‡¶™‡ßÅ‡¶≤‡¶ø‡¶Ç' 
# ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¨‡¶≤‡ßá‡¶õ‡¶ø ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶ü‡¶æ‡¶∞‡ßá, ‡¶∏‡ßç‡¶™‡ßç‡¶≤‡¶ø‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡ßÆ‡ß¶ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç, ‡ßß‡ß¶ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶®, ‡ßß‡ß¶ ‡¶ü‡ßá‡¶∏‡ßç‡¶ü‡¶∏‡ßá‡¶ü ‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂‡ßá

split = (80, 10, 10)
splits = tfds.Split.TRAIN.subsplit(weighted=split)

(cat_train, cat_valid, cat_test), info = tfds.load('cats_vs_dogs', split=list(splits), with_info=True, as_supervised=True)
```

```text
[1mDownloading and preparing dataset cats_vs_dogs (786.68 MiB) to /root/tensorflow_datasets/cats_vs_dogs/2.0.1...[0m



HBox(children=(IntProgress(value=1, bar_style='info', description='Dl Completed...', max=1, style=ProgressStyl‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Dl Size...', max=1, style=ProgressStyle(des‚Ä¶


/usr/local/lib/python3.6/dist-packages/urllib3/connectionpool.py:847: InsecureRequestWarning: Unverified HTTPS request is being made. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
  InsecureRequestWarning)








HBox(children=(IntProgress(value=1, bar_style='info', max=1), HTML(value='')))


WARNING:absl:1738 images were corrupted and were skipped





HBox(children=(IntProgress(value=0, description='Shuffling...', max=20, style=ProgressStyle(description_width=‚Ä¶


WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_datasets/core/file_format_adapter.py:209: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`


WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_datasets/core/file_format_adapter.py:209: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1164, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1164, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶



HBox(children=(IntProgress(value=1, bar_style='info', description='Reading...', max=1, style=ProgressStyle(des‚Ä¶



HBox(children=(IntProgress(value=0, description='Writing...', max=1163, style=ProgressStyle(description_width=‚Ä¶


[1mDataset cats_vs_dogs downloaded and prepared to /root/tensorflow_datasets/cats_vs_dogs/2.0.1. Subsequent calls will reuse this data.[0m
```

```python
# ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶¶‡ßá‡¶ñ‡¶ø ‡¶°‡ßá‡¶ü‡¶æ‡¶∏‡ßá‡¶ü‡ßá ‡¶ï‡¶ø ‡¶Ü‡¶õ‡ßá?

get_label_name = info.features['label'].int2str
for image, label in cat_test.take(2):
  plt.figure()
  plt.imshow(image)
  plt.title(get_label_name(label))
  image_ = image
```

![png](../.gitbook/assets/output_5_0.png)

![png](../.gitbook/assets/output_5_1.png)

```python
# ‡¶è‡¶á ‡¶Ö‡¶¨‡¶ú‡ßá‡¶ï‡ßç‡¶ü‡¶ó‡ßÅ‡¶≤‡ßã (‡¶á‡¶Æ‡ßá‡¶ú, ‡¶≤‡ßá‡¶¨‡ßá‡¶≤) ‡¶ú‡ßã‡ßú‡¶æ‡ßü ‡¶Ü‡¶õ‡ßá, ‡¶∂‡ßá‡¶™, ‡ß© ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶≤‡ßá‡¶¨‡ßá‡¶≤ ‡¶∏‡ßç‡¶ï‡ßá‡¶≤‡¶æ‡¶∞‡ßá ‡¶Ü‡¶õ‡ßá

print(cat_train)
print(cat_valid)
print(cat_test)
```

```text
<_OptionsDataset shapes: ((None, None, 3), ()), types: (tf.uint8, tf.int64)>
<_OptionsDataset shapes: ((None, None, 3), ()), types: (tf.uint8, tf.int64)>
<_OptionsDataset shapes: ((None, None, 3), ()), types: (tf.uint8, tf.int64)>
```

```python
# ‡¶á‡¶Æ‡ßá‡¶ú ‡¶™‡ßç‡¶∞‡¶ø-‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡¶õ‡¶ø, ‡ßß‡ß¨‡ß¶ ‡¶™‡¶ø‡¶ï‡ßç‡¶∏‡ßá‡¶≤‡ßá

# IMAGE_SIZE = 100
# def pre_process_image(image, label):
# image = tf.cast(image, tf.float32)
# image = image / 255.0
# image = tf.image.resize(image, (IMAGE_SIZE, IMAGE_SIZE))
# return image, label

IMAGE_SIZE = 160 

def pre_process_image(image, label):
  image = tf.cast(image, tf.float32)
  image = (image/127.5) - 1
  image = tf.image.resize(image, (IMAGE_SIZE, IMAGE_SIZE))
  return image, label
```

```python
# ‡¶è‡¶á ‡¶è‡¶ï‡¶á ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶ï‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡¶ø ‡¶°‡ßá‡¶ü‡¶æ‡¶∏‡ßá‡¶ü‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶æ ‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ ‡¶®‡¶ø‡ßü‡ßá, ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶Æ‡ßá‡¶•‡¶°‡ßá 

# TRAIN_BATCH_SIZE = 64
# cat_train = cat_train.map(pre_process_image).shuffle(1000).repeat().batch(TRAIN_BATCH_SIZE)
# cat_valid = cat_valid.map(pre_process_image).repeat().batch(1000)

# ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá '‡¶∂‡¶æ‡¶´‡¶≤' ‡¶ï‡¶∞‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö ‡¶∏‡¶æ‡¶á‡¶ú‡¶ì ‡¶¨‡¶≤‡ßá ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡¶ø

BATCH_SIZE = 32
SHUFFLE_BUFFER_SIZE = 1000

cat_train = cat_train.map(pre_process_image)
cat_valid = cat_valid.map(pre_process_image)
cat_test = cat_test.map(pre_process_image)
```

```python
# ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö

train_batches = cat_train.shuffle(SHUFFLE_BUFFER_SIZE).batch(BATCH_SIZE)
validation_batches = cat_valid.batch(BATCH_SIZE)
test_batches = cat_test.batch(BATCH_SIZE)
```

```python
# ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö, ‡¶á‡¶Æ‡ßá‡¶ú ‡¶∏‡¶æ‡¶á‡¶ú, ‡¶á‡¶Æ‡ßá‡¶ú ‡¶∏‡¶æ‡¶á‡¶ú, ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤

for image_batch, label_batch in train_batches.take(1):
   pass

image_batch.shape
```

```text
TensorShape([32, 160, 160, 3])
```

## ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ï‡¶®‡¶≠‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶¨‡ßá‡¶á‡¶ú, ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶æ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶π‡ßá‡¶°

‡¶è‡¶ï‡¶ü‡¶æ ‚Äò‡¶ï‡¶®‡¶≠‡¶≤‡¶ø‡¶â‡¶∂‡¶®‡¶æ‡¶≤ ‡¶®‡¶ø‡¶â‡¶∞‡¶æ‡¶≤‚Äô ‡¶®‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶ï‡ßá ‡¶ï‡¶ø ‡¶Ü‡¶õ‡ßá? ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ï‡¶®‡¶≠‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶¨‡ßá‡¶á‡¶ú, ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ü‡¶æ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶π‡ßá‡¶°‡•§ ‡¶¨‡ßá‡¶∂‡¶ø‡¶∞‡¶≠‡¶æ‡¶ó ‡¶∏‡¶Æ‡¶Ø‡¶º ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶ï‡¶®‡¶≠‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶¨‡ßá‡¶á‡¶ú ‡¶†‡¶ø‡¶ï ‡¶∞‡ßá‡¶ñ‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶π‡ßá‡¶° ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶≤‡ßá‡¶á ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø ‡¶∏‡¶π‡¶ú‡ßá‡¶á‡•§ ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá‡¶á ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶§‡ßà‡¶∞‡¶ø ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶ö‡ßç‡¶õ‡ßá‡¶¶ ‡¶ï‡¶∞‡¶¨‡ßã ‡¶Ü‡¶Æ‡¶∞‡¶æ‡•§ ‡¶§‡¶ñ‡¶® ‡¶¨‡ßÅ‡¶ù‡¶¨ ‡¶∏‡ßá‡¶á ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶ï‡¶§‡¶ü‡ßÅ‡¶ï‡ßÅ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‚Äò‡¶Ü‡¶®‡¶ï‡ßã‡¶∞‡¶æ‚Äô ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨ ‡¶Ü‡¶∞ ‡¶ï‡¶§‡¶ü‡ßÅ‡¶ï‡ßÅ ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶∞‡ßá ‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶® ‡¶ï‡¶∞‡ßá ‡¶®‡ßá‡¶¨ ‡¶∏‡ßá‡¶ü‡¶æ ‡¶π‡¶æ‡¶§‡ßá‡¶ï‡¶≤‡¶Æ‡ßá ‡¶¶‡ßá‡¶ñ‡¶¨‡ßã ‡¶∏‡¶æ‡¶Æ‡¶®‡ßá‡•§

‡¶Ö‡¶®‡ßá‡¶ï ‡¶ó‡¶≤‡ßç‡¶™ ‡¶π‡¶≤, ‡¶è‡¶á ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡¶¨ ‡¶∏‡ßá‡¶ü‡¶æ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ü‡¶≤‡¶æ‡¶™ ‡¶ï‡¶∞‡¶õ‡¶ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá‡•§

```python
# ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶•‡¶æ

head = tf.keras.Sequential()
head.add(layers.Conv2D(32, (3, 3), input_shape=(IMAGE_SIZE, IMAGE_SIZE, 3)))
head.add(layers.BatchNormalization())
head.add(layers.Activation('relu'))
head.add(layers.MaxPooling2D(pool_size=(2, 2)))

head.add(layers.Conv2D(32, (3, 3)))
head.add(layers.BatchNormalization())
head.add(layers.Activation('relu'))
head.add(layers.MaxPooling2D(pool_size=(2, 2)))

head.add(layers.Conv2D(64, (3, 3)))
head.add(layers.BatchNormalization())
head.add(layers.Activation('relu'))
head.add(layers.MaxPooling2D(pool_size=(2, 2)))
```

```python
# average_pool = tf.keras.Sequential()
# average_pool.add(layers.AveragePooling2D())
# average_pool.add(layers.Flatten())
# average_pool.add(layers.Dense(1, activation='sigmoid'))

# ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶è‡¶≠‡¶æ‡¶∞‡ßá‡¶ú ‡¶™‡ßÅ‡¶≤, ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶ú ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡¶æ ‡ßß‡ß®‡ßÆ‡ß¶ ‡¶è‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶≠‡ßá‡¶ï‡ßç‡¶ü‡¶∞‡ßá ‡¶ï‡¶®‡¶≠‡¶æ‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶æ ‡¶á‡¶Æ‡ßá‡¶ú‡ßá
average_pool = tf.keras.layers.GlobalAveragePooling2D()
# ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡ßá‡¶°‡¶ø‡¶ï‡¶∂‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶æ ‡¶á‡¶Æ‡ßá‡¶ú‡ßá, ‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠‡ßá‡¶∂‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶®‡ßá‡¶á, ‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ ‡¶™‡¶ú‡¶ø‡¶ü‡¶ø‡¶≠ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡ßß, ‡¶®‡ßá‡¶ó‡ßá‡¶ü‡¶ø‡¶≠ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡ß¶
prediction = keras.layers.Dense(1)
```

‡ßß. ‚Äò‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶°‚Äô ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶•‡ßá‡¶ï‡ßá ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡¶∂‡¶®: ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶∞‡¶ø‡¶™‡ßç‡¶∞‡ßá‡¶ú‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∂‡¶® ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶®‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶ï ‡¶•‡ßá‡¶ï‡ßá ‡¶∂‡¶ø‡¶ñ‡ßá ‡¶∏‡ßá‡¶ü‡¶æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï‡ßá‡¶∞ ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶¨ ‡¶®‡¶§‡ßÅ‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶•‡ßá‡¶ï‡ßá‡•§ ‡¶è‡¶∞ ‡¶∂‡ßá‡¶∑‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶π‡ßá‡¶° ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡¶¨ ‡¶Ø‡¶æ‡¶ï‡ßá ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶æ‡¶≤‡ßá‡¶á ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá ‡¶Ü‡¶®‡¶ï‡ßã‡¶∞‡¶æ ‡¶∞‡¶æ‡¶ñ‡¶≤‡ßá‡¶ì ‡¶ï‡¶æ‡¶ú ‡¶π‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§ ‡¶è‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶• ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶° ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡¶ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ï‡¶æ‡¶ú‡ßá‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶™‡ßÅ‡¶∞‡ßã ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá ‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶® ‡¶ï‡¶∞‡¶õ‡¶ø‡¶®‡¶æ, ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶π‡ßá‡¶°‡¶ï‡ßá ‡¶∏‡ßá‡¶á ‡¶ï‡¶Ø‡¶º‡ßá‡¶ï‡¶ü‡¶æ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶® ‡¶ï‡¶∞‡¶≤‡ßá‡¶á ‡¶ö‡¶≤‡¶õ‡ßá‡•§ ‡¶™‡ßá‡¶õ‡¶®‡ßá ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶ï‡¶®‡¶≠‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶¨‡ßá‡¶á‡¶ú ‡¶è‡¶ï‡¶á ‡¶•‡¶æ‡¶ï‡¶õ‡ßá‡•§ ‡¶Æ‡¶æ‡¶®‡ßá ‡¶è‡¶ï ‡¶®‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶ï ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡¶®‡¶≠‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶¨‡ßá‡¶á‡¶ú ‡¶è‡¶¨‡¶Ç ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶®‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶ï ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶π‡ßá‡¶° \(‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶Ç‡¶∂\) ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶≤‡ßá‡¶á ‡¶ï‡¶æ‡¶ú ‡¶π‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§

```python
# ‡¶§‡¶ø‡¶®‡¶ü‡¶æ ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßá ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶§‡ßà‡¶∞‡¶ø
standard_model = tf.keras.Sequential([
    head, 
    average_pool,
    prediction
])
```

```python
# ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡ß®‡¶ü‡¶æ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏, ‡¶∏‡ßá‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶≤‡¶∏ 'binary_crossentropy'

# standard_model.compile(optimizer=tf.keras.optimizers.Adam(),
#              loss='binary_crossentropy',
#              metrics=['accuracy'])

base_learning_rate = 0.0001
standard_model.compile(optimizer=tf.keras.optimizers.RMSprop(lr=base_learning_rate),
              loss='binary_crossentropy',
              metrics=['accuracy'])
```

```python
# ‡¶ü‡ßá‡¶®‡ßç‡¶∏‡¶∞-‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶¶‡ßá‡¶ñ‡¶¨‡ßã ‡¶®‡¶æ? ‡¶Ü‡¶ó‡ßá ‡¶Ü‡¶≤‡¶æ‡¶™ ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø

callbacks = [tf.keras.callbacks.TensorBoard(log_dir='./log/standard_model', update_freq='batch')]
```

```python
# ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶õ‡¶¨‡¶ø‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶ó‡ßÅ‡¶®‡ßá ‡¶®‡ßá‡¶á ‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®, ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶® ‡¶è‡¶¨‡¶Ç ‡¶ü‡ßá‡¶∏‡ßç‡¶ü‡¶∏‡ßá‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

# standard_model.fit(cat_train, steps_per_epoch = 23262//TRAIN_BATCH_SIZE, epochs=7, 
#               validation_data=cat_valid, validation_steps=10, callbacks=callbacks)

num_train, num_val, num_test = (
  info.splits['train'].num_examples*weight/10
  for weight in split
)
```

```python
# ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶á‡¶™‡¶ï ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶æ ‡¶á‡¶™‡¶ï‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡ßá‡¶™ ‡¶¨‡¶≤‡ßá ‡¶¶‡ßá‡¶á

initial_epochs = 10
steps_per_epoch = round(num_train)//BATCH_SIZE
validation_steps = 20

loss0,accuracy0 = standard_model.evaluate(validation_batches, steps = validation_steps)
```

```text
20/20 [==============================] - 6s 285ms/step - loss: 1.2152 - accuracy: 0.5125
```

```python
# ‡¶ß‡¶æ‡¶∞‡¶£‡¶æ ‡¶ï‡¶∞‡¶ø ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶Ø‡ßÅ‡¶∞‡ßá‡¶∏‡¶ø ‡¶Ü‡¶∞ ‡¶≤‡¶∏‡ßá‡¶∞ ‡¶Ö‡¶Ç‡¶ï

print("initial loss: {:.2f}".format(loss0))
print("initial accuracy: {:.2f}".format(accuracy0))
```

```text
initial loss: 1.22
initial accuracy: 0.51
```

```python
# ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç, ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá, ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞‡ßç‡¶° ‡¶Æ‡¶°‡ßá‡¶≤, ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶õ‡¶æ‡ßú‡¶æ
# ‡¶ï‡¶≤‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï, ‡¶ü‡ßá‡¶®‡ßç‡¶∏‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

history = standard_model.fit(train_batches,
                    epochs=initial_epochs,
                    validation_data=validation_batches,
                    callbacks=callbacks)
```

```text
Epoch 1/10
      1/Unknown - 5s 5s/step - loss: 2.6915 - accuracy: 0.5625WARNING:tensorflow:Method (on_train_batch_end) is slow compared to the batch update (0.235030). Check your callbacks.


WARNING:tensorflow:Method (on_train_batch_end) is slow compared to the batch update (0.235030). Check your callbacks.


      2/Unknown - 5s 3s/step - loss: 2.1321 - accuracy: 0.4688WARNING:tensorflow:Method (on_train_batch_end) is slow compared to the batch update (0.228094). Check your callbacks.


WARNING:tensorflow:Method (on_train_batch_end) is slow compared to the batch update (0.228094). Check your callbacks.


582/582 [==============================] - 101s 174ms/step - loss: 0.6875 - accuracy: 0.6331 - val_loss: 0.0000e+00 - val_accuracy: 0.0000e+00
Epoch 2/10
582/582 [==============================] - 97s 167ms/step - loss: 0.6353 - accuracy: 0.6803 - val_loss: 0.6358 - val_accuracy: 0.7043
Epoch 3/10
582/582 [==============================] - 97s 166ms/step - loss: 0.6132 - accuracy: 0.7012 - val_loss: 0.5828 - val_accuracy: 0.7237
Epoch 4/10
582/582 [==============================] - 96s 165ms/step - loss: 0.6060 - accuracy: 0.7082 - val_loss: 0.7234 - val_accuracy: 0.6552
Epoch 5/10
582/582 [==============================] - 96s 166ms/step - loss: 0.6055 - accuracy: 0.7168 - val_loss: 0.6674 - val_accuracy: 0.6901
Epoch 6/10
582/582 [==============================] - 97s 167ms/step - loss: 0.5945 - accuracy: 0.7251 - val_loss: 0.5868 - val_accuracy: 0.7366
Epoch 7/10
582/582 [==============================] - 97s 166ms/step - loss: 0.5907 - accuracy: 0.7294 - val_loss: 0.6013 - val_accuracy: 0.7310
Epoch 8/10
582/582 [==============================] - 96s 164ms/step - loss: 0.5897 - accuracy: 0.7298 - val_loss: 0.6565 - val_accuracy: 0.6810
Epoch 9/10
582/582 [==============================] - 96s 165ms/step - loss: 0.5854 - accuracy: 0.7337 - val_loss: 0.6246 - val_accuracy: 0.7004
Epoch 10/10
582/582 [==============================] - 97s 166ms/step - loss: 0.5960 - accuracy: 0.7364 - val_loss: 0.5645 - val_accuracy: 0.7539
```

```python
# ‡¶ü‡ßá‡¶®‡ßç‡¶∏‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶õ‡¶ø, ‡¶§‡¶¨‡ßá ‡¶∂‡ßá‡¶∑‡ßá ‡¶¶‡ßá‡¶ñ‡¶≤‡ßá ‡¶≠‡¶æ‡¶≤‡ßã

%tensorboard --logdir log/
```

  
  \(function\(\) {  
    window.TENSORBOARD\_ENV = window.TENSORBOARD\_ENV \|\| {};  
    window.TENSORBOARD\_ENV\["IN\_COLAB"\] = true;  
    document.querySelector\("base"\).href = "https://localhost:6006";  
    function fixUpTensorboard\(root\) {  
      const tftb = root.querySelector\("tf-tensorboard"\);  
      // Disable the fragment manipulation behavior in Colab. Not  
      // only is the behavior not useful \(as the iframe's location  
      // is not visible to the user\), it causes TensorBoard's usage  
      // of \`window.replace\` to navigate away from the page and to  
      // the \`localhost:&lt;port&gt;\` URL specified by the base URI, which  
      // in turn causes the frame to \(likely\) crash.  
      tftb.removeAttribute\("use-hash"\);  
    }  
    function executeAllScripts\(root\) {  
      // When \`script\` elements are inserted into the DOM by  
      // assigning to an element's \`innerHTML\`, the scripts are not  
      // executed. Thus, we manually re-insert these scripts so that  
      // TensorBoard can initialize itself.  
      for \(const script of root.querySelectorAll\("script"\)\) {  
        const newScript = document.createElement\("script"\);  
        newScript.type = script.type;  
        newScript.textContent = script.textContent;  
        root.appendChild\(newScript\);  
        script.remove\(\);  
      }  
    }  
    function setHeight\(root, height\) {  
      // We set the height dynamically after the TensorBoard UI has  
      // been initialized. This avoids an intermediate state in  
      // which the container plus the UI become taller than the  
      // final width and cause the Colab output frame to be  
      // permanently resized, eventually leading to an empty  
      // vertical gap below the TensorBoard UI. It's not clear  
      // exactly what causes this problematic intermediate state,  
      // but setting the height late seems to fix it.  
      root.style.height = \`${height}px\`;  
    }  
    const root = document.getElementById\("root"\);  
    fetch\("."\)  
      .then\(\(x\) =&gt; x.text\(\)\)  
      .then\(\(html\) =&gt; void \(root.innerHTML = html\)\)  
      .then\(\(\) =&gt; fixUpTensorboard\(root\)\)  
      .then\(\(\) =&gt; executeAllScripts\(root\)\)  
      .then\(\(\) =&gt; setHeight\(root, 800\)\);  
  }\)\(\);  
 ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶ú‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡¶æ ‡¶¨‡ßá‡¶á‡¶ú ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶¨ ‡¶Ö‡¶ï‡ßç‡¶∏‡¶´‡ßã‡¶∞‡ßç‡¶° ‡¶á‡¶â‡¶®‡¶ø‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶ø‡¶ü‡¶ø‚Äô‡¶∞ ‡¶≠‡¶ø‡¶ú‡ßç‡¶Ø‡ßÅ‡ßü‡¶æ‡¶≤ ‡¶ú‡¶ø‡¶ì‡¶Æ‡ßá‡¶ü‡ßç‡¶∞‡¶ø ‡¶ó‡ßç‡¶∞‡ßÇ‡¶™‡ßá‡¶∞ vgg16 ‡¶°‡¶æ‡¶ü‡¶æ‡¶∏‡ßá‡¶ü ‡¶•‡ßá‡¶ï‡ßá‡•§ ‡¶è‡¶ü‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶° ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶Ø‡¶æ ‡¶Ü‡¶∏‡¶≤‡ßá ‚Äò‡¶á‡¶Æ‡ßá‡¶ú‡¶®‡ßá‡¶ü‚Äô ‡¶®‡¶æ‡¶Æ‡ßá ‡¶è‡¶ï‡¶ü‡¶æ ‡¶¨‡¶ø‡¶∂‡¶æ‡¶≤ ‡¶°‡¶æ‡¶ü‡¶æ‡¶∏‡ßá‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ú‡¶æ‡¶®‡¶ø ‡¶Ø‡ßá ‚Äò‡¶á‡¶Æ‡ßá‡¶ú‡¶®‡ßá‡¶ü‚Äô ‡¶Ü‡¶∏‡¶≤‡ßá ‡ßß‡ß™ ‡¶≤‡¶ï‡ßç‡¶∑ ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶ü ‡¶Ø‡¶æ‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶π‡¶æ‡¶ú‡¶æ‡¶∞‡ßã ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü‡ßá‡¶∞ ‡¶õ‡¶¨‡¶ø‡¶∞ ‡ßß‡ß¶‡ß¶‡ß¶ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶¨‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶ó‡¶∞‡¶ø ‡¶Ü‡¶õ‡ßá‡•§ ‡¶è‡¶∞‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶ï‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶®‡ßá‡¶á ‡¶∏‡ßá‡¶ü‡¶æ‡¶á ‡¶Ö‡¶®‡ßá‡¶ï ‡¶ö‡¶ø‡¶®‡ßç‡¶§‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¨‡¶≤‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ø‡ßá ‡¶õ‡¶¨‡¶ø ‡¶™‡ßç‡¶∞‡ßá‡¶°‡¶ø‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶¨‡ßã ‡¶∏‡ßá‡¶á ‡¶õ‡¶¨‡¶ø ‡¶á‡¶Æ‡ßá‡¶ú‡¶®‡ßá‡¶ü‡ßá ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø ‡¶®‡ßá‡¶á ‡¶§‡¶æ‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡¶°‡¶º ‡¶¨‡ßç‡¶Ø‡¶æ‡¶™‡¶æ‡¶∞ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶á‡¶Æ‡ßá‡¶ú‡¶®‡ßá‡¶ü‡¶ï‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡¶ø ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ ![](https://raw.githubusercontent.com/raqueeb/deep_learning_book/master/assets/vgg16.png) ‡¶ö‡¶ø‡¶§‡ßç‡¶∞‡¶É VGG-16 ‡¶Æ‡¶°‡ßá‡¶≤, ‡¶¨‡ßç‡¶≤‡¶ï ‡¶¶‡¶ø‡ßü‡ßá ‡¶è‡¶ñ‡¶® ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞‡¶ï‡ßá ‡¶ö‡¶ø‡¶®‡ßç‡¶§‡¶æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶° ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶ï‡ßã‡¶® ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ü‡¶æ‡¶ï‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨ ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡¶∂‡¶® ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶∂‡ßá‡¶∑‡ßá‡¶∞ ‡¶Ø‡ßá ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ \(‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ‚Äô‡¶∞, ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶Æ‡ßá‡¶∂‡¶ø‡¶® ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Æ‡¶°‡ßá‡¶≤‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶Ø‡¶º ‡¶®‡¶ø‡¶ö ‡¶•‡ßá‡¶ï‡ßá ‡¶â‡¶™‡¶∞‡ßá\) ‡¶∏‡ßá‡¶ü‡¶æ ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡¶∂‡¶® ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶≠‡¶æ‡¶≤‡ßã ‡¶®‡¶Ø‡¶º‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶∂‡ßá‡¶∑‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ü‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶ø ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶≤‡ßá‡ßü‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶â‡¶ü‡¶™‡ßÅ‡¶ü‡¶ï‡ßá ‚Äò‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶®‚Äô ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ ‡¶§‡¶æ‡¶∞ ‡¶†‡¶ø‡¶ï ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßá ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶è‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞‡¶ü‡¶æ ‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶® ‡¶≤‡ßá‡ßü‡¶æ‡¶∞‡•§ ‡¶Ü‡¶∞ ‡¶§‡¶æ‡¶∞ ‡¶†‡¶ø‡¶ï ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ü‡¶æ‡¶á ‡¶∏‡ßç‡¶™‡ßá‡¶∂‡¶æ‡¶≤‡¶æ‡¶á‡¶ú‡¶° ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡•§ ‡¶â‡¶™‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶ø‡¶ö ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶Ü‡¶∏‡ßç‡¶§‡ßá ‡¶Ü‡¶∏‡ßç‡¶§‡ßá ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡ßá‡¶ï‡ßç‡¶∏ ‡¶π‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡ßá ‡¶¨‡¶≤‡ßá ‡¶∂‡ßá‡¶∑‡ßá‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá‡¶∞ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∏‡ßç‡¶™‡ßá‡¶∂‡¶æ‡¶≤‡¶æ‡¶á‡¶ú‡¶° ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡•§ ‡¶è‡¶á ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ï‡ßá ‡¶¨‡¶≤‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‚Äò‡¶¨‡¶ü‡¶≤‡¶®‡ßá‡¶ï‚Äô ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡•§ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‚Äò‡¶¨‡¶ü‡¶≤‡¶®‡ßá‡¶ï‚Äô ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ñ‡ßÅ‡¶¨‡¶á ‡¶∏‡ßç‡¶™‡ßá‡¶∏‡¶ø‡¶´‡¶ø‡¶ï ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶•‡¶æ‡¶ï‡ßá‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶Æ‡¶°‡ßá‡¶≤‡¶ï‡ßá ‡¶Ø‡¶ñ‡¶® ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏‡¶ø‡ßü‡ßá‡¶ü ‡¶ï‡¶∞‡¶¨ ‡¶§‡¶ñ‡¶® include\_top=False ‡¶Ü‡¶∞‡ßç‡¶ó‡ßÅ‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡¶ø‡¶≤‡ßá‡¶á ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶•‡¶æ‡¶ï‡¶¨‡ßá‡¶®‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá‡•§ ‡¶ü‡¶™ ‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶õ‡¶æ‡ßú‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶®‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶ï ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá‡•§ ‡¶è‡¶ü‡¶æ‡¶á ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‚Äò‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡¶∂‡¶®‚Äô ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶≠‡¶æ‡¶≤‡ßã ‡¶Ö‡¶™‡¶∂‡¶®‡•§ ![](https://raw.githubusercontent.com/raqueeb/deep_learning_book/master/assets/vgg-tune.png) ‡¶ö‡¶ø‡¶§‡ßç‡¶∞‡¶É VGG-16 ‡¶Æ‡¶°‡ßá‡¶≤, ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶ü‡¶∞ ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶´‡¶æ‡¶á‡¶® ‡¶ü‡¶ø‡¶â‡¶®‡¶ø‡¶Ç \`\`\`python \# ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶•‡¶æ IMG\_SHAPE = \(IMAGE\_SIZE, IMAGE\_SIZE, 3\) vgg = tf.keras.applications.vgg16.VGG16\(weights='imagenet', include\_top=False, input\_shape=IMG\_SHAPE\) \`\`\` Downloading data from https://github.com/fchollet/deep-learning-models/releases/download/v0.1/vgg16\_weights\_tf\_dim\_ordering\_tf\_kernels\_notop.h5 58892288/58889256 \[==============================\] - 2s 0us/step \`\`\`python \# ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶Ç‡¶∂ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡¶ø ‡¶¶‡ßÅ‡¶ü‡ßã ‡¶¨‡¶æ‡ßú‡¶§‡¶ø ‡¶≤‡ßá‡ßü‡¶æ‡¶∞ average\_pool = tf.keras.layers.GlobalAveragePooling2D\(\) prediction = keras.layers.Dense\(1\) \`\`\` ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ vgg16 ‡¶Æ‡¶°‡ßá‡¶≤‡ßá ‡ßß‡ß©‡¶ü‡¶æ ‡¶ï‡¶®‡¶≠‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Ü‡¶õ‡ßá‡•§ ‡¶è‡¶∞‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡ß©,‡ß© ‡¶ï‡¶®‡¶≠‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏ ‡¶™‡ßÅ‡¶≤‡¶ø‡¶Ç ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Ü‡¶õ‡ßá ‡¶°‡¶æ‡¶â‡¶® ‡¶∏‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡¶≤‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¶‡ßÅ‡¶ü‡ßã ‡¶´‡ßÅ‡¶≤‡¶≤‡¶ø ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü‡ßá‡¶° ‡¶π‡¶ø‡¶°‡ßá‡¶® ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Ø‡¶æ‡¶∞ ‡ß™‡ß¶‡ßØ‡ß¨ ‡¶®‡ßã‡¶° ‡¶á‡¶â‡¶®‡¶ø‡¶ü ‡¶Ü‡¶õ‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶æ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡•§ ‡¶è‡¶∞‡¶™‡¶∞‡ßá ‡ßß‡ß¶‡ß¶‡ß¶ ‡¶á‡¶â‡¶®‡¶ø‡¶ü‡ßá‡¶∞ ‚Äò‡¶°‡ßá‡¶®‡ßç‡¶∏ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‚Äô ‡¶Ø‡¶æ ‡¶Ü‡¶∏‡¶≤‡ßá ‡ßß‡ß¶‡ß¶‡ß¶ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø‡¶∞ ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ï‡ßá ‡¶Ü‡¶á‡¶°‡ßá‡¶®‡ßç‡¶ü‡¶ø‡¶´‡¶æ‡¶á ‡¶ï‡¶∞‡¶õ‡ßá‡•§ ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶∏‡¶≤‡ßá ‡¶∂‡ßá‡¶∑‡ßá‡¶∞ ‡ß© ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶™‡¶°‡¶º‡¶õ‡ßá ‡¶®‡¶æ, ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶®‡¶ø‡¶ú‡ßá‡¶¶‡ßá‡¶∞ ‡¶´‡ßÅ‡¶≤‡¶≤‡¶ø ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü‡ßá‡¶° ‡¶°‡ßá‡¶®‡ßç‡¶∏ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨ ‡¶™‡ßç‡¶∞‡ßá‡¶°‡¶ø‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶§‡ßá - ‡¶Ø‡ßá ‡¶Ü‡¶∏‡¶≤‡ßá ‡¶õ‡¶¨‡¶ø‡¶ü‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ï‡ßÅ‡¶ï‡ßÅ‡¶∞‡ßá‡¶∞ ‡¶®‡¶æ ‡¶¨‡¶ø‡¶°‡¶º‡¶æ‡¶≤‡ßá‡¶∞? ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶™‡¶æ‡¶Å‡¶ö‡¶ü‡¶æ ‡¶¨‡ßç‡¶≤‡¶ï ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶¨‡ßç‡¶Ø‡¶∏‡ßç‡¶§ ‡¶•‡¶æ‡¶ï‡¶¨‡ßã ‡¶Ø‡ßá‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Ü‡¶∏‡¶≤‡ßá ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡¶ü‡¶∞ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶π‡¶¨‡ßá‡•§ ‡¶õ‡¶¨‡¶ø ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®‡•§ ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶Æ‡¶°‡ßá‡¶≤‡ßá ‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶¨ ‡¶∏‡ßá ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶™‡¶æ‡¶Å‡¶ö‡¶ü‡¶æ ‡¶ï‡¶®‡¶≠‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶¨‡ßç‡¶≤‡¶ï‡¶ï‡ßá ‚Äò‡¶´‡ßç‡¶∞‡¶ø‡¶ú‚Äô ‡¶Æ‡¶æ‡¶®‡ßá ‚Äò‡¶≤‡¶ï‚Äô ‡¶ï‡¶∞‡ßá ‡¶´‡ßá‡¶≤‡¶¨ ‡¶Ø‡¶æ‡¶§‡ßá ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ì‡¶Ø‡¶º‡ßá‡¶ü‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶§‡ßá ‡¶®‡¶æ ‡¶™‡¶æ‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶æ ‡¶á‡¶™‡¶ï‡ßá‡¶∞ ‡¶™‡¶∞‡•§ ‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‚Äò‡¶ì‡¶Ø‡¶º‡ßá‡¶ü‚Äô ‡¶¶‡ßà‡¶¨-‡¶ö‡¶Ø‡¶º‡¶®‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶π‡¶Ø‡¶º, ‡¶§‡¶æ‡¶á ‡¶∏‡ßá‡¶á ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏‡¶ü‡¶æ ‡¶¨‡ßç‡¶≤‡¶ï‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶∂‡ßá‡¶ñ‡¶æ ‡¶ì‡¶Ø‡¶º‡ßá‡¶ü‡¶ó‡ßÅ‡¶≤‡ßã ‡¶≠‡ßÅ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§ ‡¶≠‡ßÅ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶¨‡¶≤‡¶õ‡¶ø ,‡¶è ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç‡¶ï‡ßÉ‡¶§ ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™‡¶ó‡ßÅ‡¶≤‡ßã ‡¶â‡¶≤‡ßç‡¶ü‡¶æ‡¶™‡¶æ‡¶≤‡ßç‡¶ü‡¶æ ‡¶π‡¶Ø‡¶º‡ßá ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§ ‡¶∏‡ßá ‡¶ï‡¶æ‡¶∞‡¶£‡ßá‡¶á ‡¶™‡¶æ‡¶Å‡¶ö‡¶ü‡¶æ ‡¶¨‡ßç‡¶≤‡¶ï, ‡¶Æ‡¶æ‡¶®‡ßá ‡¶∏‡¶¨ ‡¶¨‡ßç‡¶≤‡¶ï‡¶ï‡ßá‡¶á ‚Äò‡¶≤‡¶ï‚Äô ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡¶ø‡•§ \`\`\`python \# ‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶° ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶•‡¶æ ‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶® ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ, ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶≤‡¶ï vgg.trainable = False \`\`\` \`\`\`python \# ‡¶¶‡ßá‡¶ñ‡¶ø ‡¶≤‡ßá‡ßü‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ, ‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶® ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ import pandas as pd pd.set\_option\('max\_colwidth', -1\) layer\_vgg = \[\(layer, layer.name, layer.trainable\) for layer in vgg.layers\] pd.DataFrame\(layer\_vgg, columns=\['Layer Type', 'Layer Name', 'Layer Trainable'\]\) \`\`\`  
    .dataframe tbody tr th:only-of-type {  
        vertical-align: middle;  
    }  
  
    .dataframe tbody tr th {  
        vertical-align: top;  
    }  
  
    .dataframe thead th {  
        text-align: right;  
    }  


|  | Layer Type | Layer Name | Layer Trainable |
| :--- | :--- | :--- | :--- |
| 0 | &lt;tensorflow.python.keras.engine.input\_layer.InputLayer object at 0x7f240242d710&gt; | input\_1 | False |
| 1 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24023cfc50&gt; | block1\_conv1 | False |
| 2 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f23efa09518&gt; | block1\_conv2 | False |
| 3 | &lt;tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f23ef9be7b8&gt; | block1\_pool | False |
| 4 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f23ef9be898&gt; | block2\_conv1 | False |
| 5 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f23ef9d0eb8&gt; | block2\_conv2 | False |
| 6 | &lt;tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f24014d8320&gt; | block2\_pool | False |
| 7 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014d8400&gt; | block3\_conv1 | False |
| 8 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014e3b70&gt; | block3\_conv2 | False |
| 9 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014f2e48&gt; | block3\_conv3 | False |
| 10 | &lt;tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f2401505fd0&gt; | block3\_pool | False |
| 11 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f2401497240&gt; | block4\_conv1 | False |
| 12 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014a79b0&gt; | block4\_conv2 | False |
| 13 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014b0c88&gt; | block4\_conv3 | False |
| 14 | &lt;tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f24014c4f60&gt; | block4\_pool | False |
| 15 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f2401455630&gt; | block5\_conv1 | False |
| 16 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014677f0&gt; | block5\_conv2 | False |
| 17 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f2401470ac8&gt; | block5\_conv3 | False |
| 18 | &lt;tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f2401483da0&gt; | block5\_pool | False |

```python
# ‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶ì‡ßü‡ßá‡¶ü ‡¶Ü‡¶õ‡ßá? ‡¶®‡¶æ‡•§

print("Trainable layers:", vgg.trainable_weights)
```

```text
Trainable layers: []
```

```python
# ‡¶®‡¶§‡ßÅ‡¶® ‡¶Æ‡¶°‡ßá‡¶≤, ‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶° ‡¶Æ‡¶°‡ßá‡¶≤ vgg16 ‡¶∏‡¶π, tl_model ‡¶Æ‡¶æ‡¶®‡ßá ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Æ‡¶°‡ßá‡¶≤ (‡¶á‡¶ö‡ßç‡¶õ‡ßá‡¶Æ‡¶§‡ßã ‡¶®‡¶æ‡¶Æ ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®)

tl_model = tf.keras.Sequential([
  vgg,
  average_pool,
  prediction,
  ])
```

```python
# ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶∞‡¶ø ‡¶¶‡ßá‡¶ñ‡¶ø

tl_model.summary()
```

```text
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
vgg16 (Model)                (None, 5, 5, 512)         14714688  
_________________________________________________________________
global_average_pooling2d_1 ( (None, 512)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 513       
=================================================================
Total params: 14,715,201
Trainable params: 513
Non-trainable params: 14,714,688
_________________________________________________________________
```

```python
# ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶á‡¶≤ ‡¶ï‡¶∞‡¶õ‡¶ø

tl_model.compile(optimizer=tf.keras.optimizers.Adam(),
              loss='binary_crossentropy',
              metrics=['accuracy'])
```

```python
# ‡¶ü‡ßá‡¶®‡ßç‡¶∏‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶°‡¶ø‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶∞‡¶ø

callbacks = [tf.keras.callbacks.TensorBoard(log_dir='./log/transer_learning_model', update_freq='batch')]
```

```python
# ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç, ‡¶Ü‡¶¨‡¶æ‡¶∞‡ßã 
# ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞ ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Æ‡¶°‡ßá‡¶≤‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

# tl_model.fit(cat_train, steps_per_epoch = 23262//TRAIN_BATCH_SIZE, epochs=7, 
#             validation_data=cat_valid, validation_steps=10, callbacks=callbacks)

history = tl_model.fit(train_batches,
                    epochs=initial_epochs,
                    validation_data=validation_batches,
                    callbacks=callbacks)
```

```text
Epoch 1/10
582/582 [==============================] - 189s 325ms/step - loss: 0.3132 - accuracy: 0.8754 - val_loss: 0.0000e+00 - val_accuracy: 0.0000e+00
Epoch 2/10
582/582 [==============================] - 180s 309ms/step - loss: 1.0520 - accuracy: 0.8543 - val_loss: 0.4390 - val_accuracy: 0.8931
Epoch 3/10
582/582 [==============================] - 179s 308ms/step - loss: 0.3531 - accuracy: 0.9094 - val_loss: 0.2435 - val_accuracy: 0.9151
Epoch 4/10
582/582 [==============================] - 178s 306ms/step - loss: 0.2465 - accuracy: 0.9230 - val_loss: 0.2078 - val_accuracy: 0.9224
Epoch 5/10
582/582 [==============================] - 178s 306ms/step - loss: 0.2139 - accuracy: 0.9282 - val_loss: 0.2050 - val_accuracy: 0.9259
Epoch 6/10
582/582 [==============================] - 180s 309ms/step - loss: 0.2187 - accuracy: 0.9272 - val_loss: 0.1988 - val_accuracy: 0.9293
Epoch 7/10
582/582 [==============================] - 178s 306ms/step - loss: 0.1987 - accuracy: 0.9328 - val_loss: 0.1847 - val_accuracy: 0.9315
Epoch 8/10
582/582 [==============================] - 179s 308ms/step - loss: 0.3989 - accuracy: 0.9092 - val_loss: 0.2609 - val_accuracy: 0.9198
Epoch 9/10
582/582 [==============================] - 179s 308ms/step - loss: 0.2313 - accuracy: 0.9275 - val_loss: 0.2001 - val_accuracy: 0.9323
Epoch 10/10
582/582 [==============================] - 179s 307ms/step - loss: 0.3393 - accuracy: 0.9205 - val_loss: 0.9187 - val_accuracy: 0.8496
```

```python
# ‡¶ü‡ßá‡¶®‡ßç‡¶∏‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°, ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡ßá

%tensorboard --logdir log/ --port=8008
```

  
  \(function\(\) {  
    window.TENSORBOARD\_ENV = window.TENSORBOARD\_ENV \|\| {};  
    window.TENSORBOARD\_ENV\["IN\_COLAB"\] = true;  
    document.querySelector\("base"\).href = "https://localhost:8008";  
    function fixUpTensorboard\(root\) {  
      const tftb = root.querySelector\("tf-tensorboard"\);  
      // Disable the fragment manipulation behavior in Colab. Not  
      // only is the behavior not useful \(as the iframe's location  
      // is not visible to the user\), it causes TensorBoard's usage  
      // of \`window.replace\` to navigate away from the page and to  
      // the \`localhost:&lt;port&gt;\` URL specified by the base URI, which  
      // in turn causes the frame to \(likely\) crash.  
      tftb.removeAttribute\("use-hash"\);  
    }  
    function executeAllScripts\(root\) {  
      // When \`script\` elements are inserted into the DOM by  
      // assigning to an element's \`innerHTML\`, the scripts are not  
      // executed. Thus, we manually re-insert these scripts so that  
      // TensorBoard can initialize itself.  
      for \(const script of root.querySelectorAll\("script"\)\) {  
        const newScript = document.createElement\("script"\);  
        newScript.type = script.type;  
        newScript.textContent = script.textContent;  
        root.appendChild\(newScript\);  
        script.remove\(\);  
      }  
    }  
    function setHeight\(root, height\) {  
      // We set the height dynamically after the TensorBoard UI has  
      // been initialized. This avoids an intermediate state in  
      // which the container plus the UI become taller than the  
      // final width and cause the Colab output frame to be  
      // permanently resized, eventually leading to an empty  
      // vertical gap below the TensorBoard UI. It's not clear  
      // exactly what causes this problematic intermediate state,  
      // but setting the height late seems to fix it.  
      root.style.height = \`${height}px\`;  
    }  
    const root = document.getElementById\("root"\);  
    fetch\("."\)  
      .then\(\(x\) =&gt; x.text\(\)\)  
      .then\(\(html\) =&gt; void \(root.innerHTML = html\)\)  
      .then\(\(\) =&gt; fixUpTensorboard\(root\)\)  
      .then\(\(\) =&gt; executeAllScripts\(root\)\)  
      .then\(\(\) =&gt; setHeight\(root, 800\)\);  
  }\)\(\);  
 \`\`\`python \# ‡¶≤‡¶Æ‡ßç‡¶¨‡¶æ ‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡ßü‡¶æ‡¶≤, ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡¶ø tl\_model.save\('cats\_dogs\_tlearn.h5'\) \`\`\` ‡ß®. ‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶° ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶´‡¶æ‡¶á‡¶® ‡¶ü‡¶ø‡¶â‡¶®‡¶ø‡¶Ç: ‡¶™‡ßÅ‡¶∞‡¶®‡ßã ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶ï‡¶®‡¶≠‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶¨‡ßá‡¶á‡¶ú‡ßá‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá‡¶∞ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‚Äò‡¶≤‡¶ï‚Äô ‡¶ï‡¶∞‡ßá ‡¶∞‡ßá‡¶ñ‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá‡¶∞ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶Ø‡¶¶‡¶ø ‚Äò‡¶Ü‡¶®‡¶≤‡¶ï‚Äô ‡¶∞‡¶æ‡¶ñ‡¶ø, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶π‡ßá‡¶° ‡¶è‡¶∞ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶æ‡¶®‡ßã ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨‡•§ ‡¶´‡¶≤‡ßá ‡¶™‡ßç‡¶∞‡¶ø-‡¶ü‡ßç‡¶∞‡ßá‡¶á‡¶®‡¶° ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑‡ßá‡¶∞ ‡¶¶‡¶ø‡¶ï‡ßá‡¶∞ ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ï‡¶æ‡¶ú ‡¶Ö‡¶®‡ßÅ‡¶∏‡¶æ‡¶∞‡ßá ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶´‡¶æ‡¶á‡¶® ‡¶ü‡¶ø‡¶â‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶æ‡¶®‡ßã ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨‡•§ ‡¶è‡¶§‡ßá ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶∏‡ßç‡¶™‡ßá‡¶∏‡¶ø‡¶´‡¶ø‡¶ï ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶≠‡¶æ‡¶≤‡ßã‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶¨‡ßá‡•§ ‡¶™‡¶∞‡ßá‡¶∞ ‡¶Ö‡¶Ç‡¶∂‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ø‡¶ñ‡¶® vgg16‡¶ï‡ßá ‡¶´‡¶æ‡¶á‡¶® ‡¶ü‡¶ø‡¶â‡¶®‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶¨, ‡¶§‡¶ñ‡¶® ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶∞ ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶•‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶¶‡ßÅ‡¶ü‡ßã ‡¶¨‡ßç‡¶≤‡¶ï‡¶ï‡ßá ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡¶¨‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶¨‡¶≤‡¶õ‡¶ø ‡¶¨‡ßç‡¶≤‡¶ï ‡ß™ ‡¶è‡¶¨‡¶Ç ‡ß´ - ‡¶Ø‡ßá‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶≤‡ßá ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ì‡¶Ø‡¶º‡ßá‡¶ü‡¶ó‡ßÅ‡¶≤‡ßã ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶á‡¶™‡¶ï‡ßá, ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶•‡ßá‡•§ ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶õ‡¶¨‡¶ø‡¶ü‡¶æ ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶¶‡ßá‡¶ñ‡¶ø‡•§ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ï‡¶Æ‡ßç‡¶™‡ßç‡¶≤‡ßá‡¶ï‡ßç‡¶∏‡¶ø‡¶ü‡¶ø ‡¶è‡¶°‡¶º‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶∞‡¶æ ‚Äò‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶è‡¶≠‡¶æ‡¶∞‡ßá‡¶ú ‡¶™‡ßÅ‡¶≤‡¶ø‡¶Ç‚Äô ‡¶Ü‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶õ‡¶ø‡¶®‡¶æ‡•§ ‡¶ï‡ßã‡¶°‡ßá ‡¶∏‡ßá‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶≤‡ßá ‡¶¨‡ßÅ‡¶ù‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®‡•§ ‡¶è‡¶á ‡¶≤‡ßá‡ßü‡¶æ‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã‡¶∞ ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶•‡ßá‡¶ï‡ßá ‡¶Ø‡ßá ‡¶Ü‡¶â‡¶ü‡¶™‡ßÅ‡¶ü ‡¶™‡¶æ‡¶¨ ‡¶∏‡ßá‡¶ü‡¶æ‡¶ï‡ßá ‡¶™‡¶æ‡¶†‡¶ø‡¶Ø‡¶º‡ßá ‡¶¶‡ßá‡¶¨ ‚Äò‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶®‚Äô ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡•§ ‡¶è‡¶∞‡¶™‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶â‡¶ü‡¶™‡ßÅ‡¶ü ‡¶ö‡¶≤‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶∞ ‚Äò‡¶°‡ßá‡¶®‡ßç‡¶∏‚Äô ‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡•§ \`\`\`python \# ‡¶è‡¶ñ‡¶® ‡¶Æ‡¶°‡ßá‡¶≤‡ßá‡¶∞ ‡¶´‡¶æ‡¶á‡¶® ‡¶ü‡¶ø‡¶â‡¶®‡¶ø‡¶Ç, ‡¶¨‡ßç‡¶≤‡¶ï ‡ß™ ‡¶è‡¶¨‡¶Ç ‡ß´ '‡¶Ü‡¶®‡¶≤‡¶ï' ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶≤‡¶æ‡¶Æ tl\_model.trainable = True set\_trainable = False for layer in vgg.layers: if layer.name in \['block5\_conv1', 'block4\_conv1'\]: set\_trainable = True if set\_trainable: layer.trainable = True else: layer.trainable = False pd.set\_option\('max\_colwidth', -1\) layer\_vgg2 = \[\(layer, layer.name, layer.trainable\) for layer in vgg.layers\] pd.DataFrame\(layer\_vgg2, columns=\['Layer Type', 'Layer Name', 'Layer Trainable'\]\) \`\`\`  
    .dataframe tbody tr th:only-of-type {  
        vertical-align: middle;  
    }  
  
    .dataframe tbody tr th {  
        vertical-align: top;  
    }  
  
    .dataframe thead th {  
        text-align: right;  
    }  


|  | Layer Type | Layer Name | Layer Trainable |
| :--- | :--- | :--- | :--- |
| 0 | &lt;tensorflow.python.keras.engine.input\_layer.InputLayer object at 0x7f240242d710&gt; | input\_1 | False |
| 1 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24023cfc50&gt; | block1\_conv1 | False |
| 2 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f23efa09518&gt; | block1\_conv2 | False |
| 3 | &lt;tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f23ef9be7b8&gt; | block1\_pool | False |
| 4 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f23ef9be898&gt; | block2\_conv1 | False |
| 5 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f23ef9d0eb8&gt; | block2\_conv2 | False |
| 6 | &lt;tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f24014d8320&gt; | block2\_pool | False |
| 7 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014d8400&gt; | block3\_conv1 | False |
| 8 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014e3b70&gt; | block3\_conv2 | False |
| 9 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014f2e48&gt; | block3\_conv3 | False |
| 10 | &lt;tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f2401505fd0&gt; | block3\_pool | False |
| 11 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f2401497240&gt; | block4\_conv1 | True |
| 12 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014a79b0&gt; | block4\_conv2 | True |
| 13 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014b0c88&gt; | block4\_conv3 | True |
| 14 | &lt;tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f24014c4f60&gt; | block4\_pool | True |
| 15 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f2401455630&gt; | block5\_conv1 | True |
| 16 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f24014677f0&gt; | block5\_conv2 | True |
| 17 | &lt;tensorflow.python.keras.layers.convolutional.Conv2D object at 0x7f2401470ac8&gt; | block5\_conv3 | True |
| 18 | &lt;tensorflow.python.keras.layers.pooling.MaxPooling2D object at 0x7f2401483da0&gt; | block5\_pool | True |

```python
# ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶ï‡¶Æ‡ßç‡¶™‡¶æ‡¶á‡¶≤ ‡¶ï‡¶∞‡¶õ‡¶ø

tl_model.compile(loss='binary_crossentropy',
              optimizer = tf.keras.optimizers.RMSprop(lr=base_learning_rate/10),
              metrics=['accuracy'])
```

```python
tl_model.summary()
```

```text
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
vgg16 (Model)                (None, 5, 5, 512)         14714688  
_________________________________________________________________
global_average_pooling2d_1 ( (None, 512)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 513       
=================================================================
Total params: 14,715,201
Trainable params: 12,979,713
Non-trainable params: 1,735,488
_________________________________________________________________
```

```python
# ‡¶ü‡ßá‡¶®‡ßç‡¶∏‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶°‡¶ø‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶∞‡¶ø

callbacks = [tf.keras.callbacks.TensorBoard(log_dir='./log/transer_learning_fine_tuning', update_freq='batch')]
```

```python
# ‡¶Æ‡¶°‡ßá‡¶≤ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡¶ø‡¶Ç, ‡¶´‡¶æ‡¶á‡¶® ‡¶ü‡¶ø‡¶â‡¶®‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

fine_tune_epochs = 10
total_epochs =  initial_epochs + fine_tune_epochs

fine_tuning = tl_model.fit(train_batches,
                         epochs=total_epochs,
                         initial_epoch = initial_epochs,
                         validation_data=validation_batches,
                         callbacks=callbacks)
```

```text
Epoch 11/20
      1/Unknown - 5s 5s/step - loss: 1.2135 - accuracy: 0.7812WARNING:tensorflow:Method (on_train_batch_end) is slow compared to the batch update (0.926102). Check your callbacks.


WARNING:tensorflow:Method (on_train_batch_end) is slow compared to the batch update (0.926102). Check your callbacks.


582/582 [==============================] - 251s 431ms/step - loss: 0.1919 - accuracy: 0.9518 - val_loss: 0.0000e+00 - val_accuracy: 0.0000e+00
Epoch 12/20
582/582 [==============================] - 241s 414ms/step - loss: 0.1190 - accuracy: 0.9748 - val_loss: 0.4140 - val_accuracy: 0.9375
Epoch 13/20
582/582 [==============================] - 242s 417ms/step - loss: 0.0777 - accuracy: 0.9854 - val_loss: 0.1355 - val_accuracy: 0.9776
Epoch 14/20
582/582 [==============================] - 242s 415ms/step - loss: 0.0526 - accuracy: 0.9916 - val_loss: 0.1369 - val_accuracy: 0.9767
Epoch 15/20
582/582 [==============================] - 241s 415ms/step - loss: 0.0409 - accuracy: 0.9941 - val_loss: 0.1532 - val_accuracy: 0.9746
Epoch 16/20
582/582 [==============================] - 243s 417ms/step - loss: 0.0362 - accuracy: 0.9954 - val_loss: 0.1592 - val_accuracy: 0.9759
Epoch 17/20
582/582 [==============================] - 242s 416ms/step - loss: 0.0367 - accuracy: 0.9962 - val_loss: 0.1789 - val_accuracy: 0.9716
Epoch 18/20
582/582 [==============================] - 243s 417ms/step - loss: 0.0340 - accuracy: 0.9962 - val_loss: 0.1441 - val_accuracy: 0.9780
Epoch 19/20
582/582 [==============================] - 242s 416ms/step - loss: 0.0259 - accuracy: 0.9973 - val_loss: 0.1897 - val_accuracy: 0.9754
Epoch 20/20
582/582 [==============================] - 243s 418ms/step - loss: 0.0266 - accuracy: 0.9973 - val_loss: 0.1324 - val_accuracy: 0.9772
```

```python
%tensorboard --logdir log/ --port=8009
```

![](https://raw.githubusercontent.com/raqueeb/deep_learning_book/master/assets/board2.PNG) ![](https://raw.githubusercontent.com/raqueeb/deep_learning_book/master/assets/board3.PNG)

